<!DOCTYPE html>
<html>
<head>
    <title>Test JWT Token</title>
</head>
<body>
    <h1>JWT Token Debugger</h1>
    <button onclick="checkToken()">Check JWT Token</button>
    <pre id="output"></pre>

    <script>
        function checkToken() {
            const token = localStorage.getItem('id_token');
            const output = document.getElementById('output');
            
            if (!token) {
                output.textContent = 'No JWT token found in localStorage';
                return;
            }
            
            try {
                const base64Url = token.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                const jsonPayload = decodeURIComponent(
                    atob(base64)
                        .split('')
                        .map((c) => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))
                        .join('')
                );
                const payload = JSON.parse(jsonPayload);
                
                output.textContent = JSON.stringify(payload, null, 2);
                
                if (payload.userId) {
                    console.log('✅ userId found:', payload.userId);
                } else {
                    console.warn('⚠️ userId NOT found in token. Available fields:', Object.keys(payload));
                }
            } catch (error) {
                output.textContent = 'Error decoding token: ' + error.message;
            }
        }
    </script>
</body>
</html>
